/**
 * ckUI
 * author:h_yang
 * version:1.7.6
 * beforeVersion:1.7.5
 * 
 * API(属性级): 
 * $.ckTrim(str),返回值为去掉前后空格  str: jquery对象||元素ID||字符串
 * $.ckIsEmail(str, ifAlert),返回是否为正确邮箱格式 str: jquery对象||元素ID||字符串 ifAlert: 是否弹出错误信息
 * $.ckIsUrl(str, ifAlert), 返回是否是正确的URL格式地址 str: jquery对象||元素ID||字符串 ifAlert: 是否弹出错误信息
 * $.ckIsMobile(str, ifAlert), 返回是否是正确格式电话号 str: jquery对象||元素ID||字符串 ifAlert: 是否弹出错误信息
 * $.ckSetCookie(name, value, path, time),设置cookie name: key value: 值 path: 域 time: 存活时间(s)
 * $.ckGetCookie(name), 获取cookie, name: key值
 * $.ckDelCookie(name), 删除cookie, name: key值
 * $.ckObjToJsonStr(obj), obj对象转json字符串,如果出现异常,则返回""
 * $.ckObjToJson(obj), obj对象转json对象, 如果出现异常则返回new Object()
 * $.ckIsEmpty(str, ifAlert), 返回是否为空值, str: jquery对象||元素ID||字符串 ifAlert: 是否弹出错误信息
 * $.ckMul(arg1, arg2), 乘法
 * $.ckAdd(arg1, arg2), 加法
 * $.ckSub(arg1, arg2), 减法
 * $.ckDiv(arg1, arg2), 除法
 * $.ckMustNumber(e, obj), 只能输入数字, 属性级函数
 * $.ckFmtMoney(s, n), s: 金额, n: 保留的小数位数
 * $.ckRbkMoney(s), s: 格式化之后的金额
 * $.ckGoto(url), 跳转url地址
 * $.ckShade(flag, time), 遮罩, flag: boolean类型,true为开启,false关闭,在开启时,重复点击则中断线程, time为持续时间,默认为4秒
 * $.ckGetContext(), 返回应用程序上下文全路径
 * $.ckGotoView(uri), 跳转带上下文的地址,uri: 请求地址,如果uri第一位不是/ 则自动加/
 * $.ckCheckCard(str, ifAlert), 返回是否是正确身份证号, str: jquery对象||元素ID||字符串 ifAlert: 是否弹出错误信息
 *
 * 
 * 更新日志: 
 * 2017-01-10更新日志: $.ckShade(true)           遮罩功能,一次调起为开启,在遮罩参数为true的时候再次调起会终止线程, $.ckShade(false) 为关闭遮罩
 * 2017-01-16更新日志: 遮罩加入显示图片
 * 2017-01-18更新日志: $.ckGetContext()          返回为不带/的根项目路径
 * 2017-01-20更新日志: $.ckShade(boolean, time), boolean 是否显示遮罩 time: 显示时间为毫秒, 遮罩默认显示5秒
 * 2017-02-08更新日志: $.ckMaxLength(length)     加入最大输入长度限制函数 length: 最大长度数
 * 2017-02-10更新日志: $.ckWhatFrameWork()       0: 安卓 1: 苹果 2: winphone 3 other
 * 2017-02-15更新日志: $.ckAlert(option)     	   弹出组件
 * 2017-02-18更新日志: $.ckSetCookie(),      	   新增参数time 单位:秒  为cookie过期时间
 * 2017-02-25更新日志: $.ckAnchor(),             页面锚点,返回上个页面自动定位到上次浏览的位置
 * 2017-03-07更新日志: $.ckIsUrl(),              是否是URL地址 
 * 2017-03-09更新日志: $.ckGotoView(uri),        带项目根路径的跳转
 * 2017-03-09更新日志: $.ckCheckCard(card, ifAlert), 检测身份证号 card: 身份证号||元素ID||jquery对象  ifAlert: 是否打印错误信息
 * 2017-03-13更新日志: 修复$.ckIsEmpty对入参的校验规则
 * 2017-04-05更新日志: 加入两种限制函数，$.ckMustEnAndNumber(适配 . -) & $.ckMustEnAndCN & $.ckMustEnAndNumberAndCn
 * 2017-04-07更新日志: 加入自定义过滤，$.ckRegular(expression)  expression 为正则表达式
 * 
 */
!function($){$.ckCache={cc:new Object,addCache:function(e,t){$.ckCache.cc[e]=t},getCache:function(e){return $.ckCache.cc[e]},clearCache:function(){$.ckCache.cc=null,$.ckCache.cc=new Object}},$.fn.extend({ckCombox:function(option){var ck=$(this);ck.empty(),ck.off();var tempOption={url:"testUrl",data:null,width:"100px",height:"30px",autoSel:!1,dataType:"json",defaultSel:!0,requestType:"GET",formatter:{root:"ckUIRoot",id:"id",value:"value",select:"select"},onSuccess:function(e){},onSelect:function(e){}},ckOption=$.extend(!0,{},tempOption,option),root=ckOption.formatter.root,ckId=ckOption.formatter.id,ckValue=ckOption.formatter.value,ckSelect=ckOption.formatter.select;ck.css("width",ckOption.width),ck.css("height",ckOption.height);var resultArray=[];return $.ajax({url:ckOption.url,type:ckOption.requestType,data:ckOption.data,dataType:ckOption.dataType,success:function(result){"ckUIRoot"!=root&&(result=result[root]),(1==ckOption.defaultSel||"true"==ckOption.defaultSel)&&ck.append('<option value="-1" selected="selected">全部</option>');for(var i in result){var tempId=result[i][ckId],tempValue=result[i][ckValue],tempJson="{"+ckId+' : "'+tempId+'" ,'+ckValue+' : "'+tempValue+'"}';resultArray.push(tempJson),1!=ckOption.autoSel||"true"!=result[i][ckSelect]?ck.append("<option value="+tempId+">"+tempValue+"</option>"):ck.append('<option selected="selected" value='+tempId+">"+tempValue+"</option>")}return ck.change(function(){ckOption.onSelect(ck)}),ckOption.onSuccess?ckOption.onSuccess(eval("(["+resultArray+"])")):void 0},error:function(e,t,n){alert("500"),console.log("与服务器通讯出现错误!")}}),ck},jqCellMerge:function(e){var t=$(this),n={judgeId:"id",mergeCellFild:["id","name"]};e?(n.judgeId=e.judgeId,n.mergeCellFild=e.mergeCellFild):(n.judgeId=t.getGridParam("judgeId"),n.mergeCellFild=t.getGridParam("mergeCellFild"));for(var r=t.getDataIDs(),o=1,i=0;i<r.length;i+=1)for(var c=r[i],a=t.getRowData(c),l=i+1;l<r.length;l+=1){var s=r[l],u=t.getRowData(s);if(a[n.judgeId]!=u[n.judgeId]){i=l-1,o=1;break}o+=1;for(var d=0;d<n.mergeCellFild.length;d+=1){var f=n.mergeCellFild[d];$("#row_"+c+"_"+a[f].trim()).attr("rowspan",o)}for(var d=0;d<n.mergeCellFild.length;d+=1){var f=n.mergeCellFild[d];$("#row_"+s+"_"+u[f].trim()).css("display","none")}}},ckMustNumber:function(){$(this).keyup(function(){$(this).val($(this).val().replace(/\D/g,""))})},ckMustEnAndNumberAndCn:function(){$(this).keyup(function(){$(this).val($(this).val().replace(/[^\a-\z\A-\Z0-9\u4E00-\u9FA5]/g,""))})},ckMustEnAndNumber:function(){$(this).keyup(function(){$(this).val($(this).val().replace(/[^\w\.\/\-]/gi,""))})},ckMustEnAndCN:function(){$(this).keyup(function(){$(this).val($(this).val().replace(/[\d]/g,""))})},ckRegular:function(e){$.ckIsEmpty(e)&&console.log("expression is null"),$(this).keyup(function(){$(this).val($(this).val().replace(e,""))})},ckMustMoney:function(e){$(this).keyup(function(e){var t=$(this).val();if(190==e.keyCode&&t.indexOf(".")!=t.lastIndexOf(".")){var n=t.substring(0,t.lastIndexOf("."));return n=n.substring(0,n.indexOf(".")+3),void $(this).val(n)}-1!=t.indexOf(".")&&(t=t.substring(0,t.indexOf(".")+3)),$(this).val(t.replace(/[^\-?\d.]/g,""))})},ckNumLimit:function(e,t){$(this).keyup(function(){$(this).val($(this).val().replace(/\D/g,""));var n=$(this).val();Number(n)>Number(t)&&$(this).val(t),Number(n)<Number(e)&&$(this).val(e)})},ckMaxLength:function(e){$(this).keyup(function(t){$(this).val().length>e&&$(this).val($(this).val().slice(0,e))})},ckWhatFrameWork:function(){var e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1?0:e.indexOf("iPhone")>-1?1:e.indexOf("Windows Phone")>-1?2:3}}),$.extend({insertAttr:function(e,t,n,r,o){return'id = "row_'+e+"_"+$.ckTrim(t)+'"'},showMsg:function(e,t,n,r){$.ckIsEmpty(r)&&(r=2500),layer.msg(e,{title:"提示:",icon:t,time:r,area:["275px","140px"],offset:"rb",shift:2},n)},ckTrim:function(e){var t=$.ckGetSomeThing(e)[1];return $.ckIsEmpty(t)?"":"string"==typeof t?t.replace(/(^\s*)|(\s*$)/g,"").replace("&#160;",""):""},ckIsEmail:function(e,t){var n=$.ckGetSomeThing(e)[0],r=$.ckGetSomeThing(e)[1],o=$.ckGetSomeThing(e)[2],i=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return i.test(r)||""==$.trim(r)?!0:(t===!0&&alert("请输入有效的邮箱地址"),o===!0&&n.focus(),!1)},ckIsUrl:function(e,t){var n=$.ckGetSomeThing(e)[0],r=$.ckGetSomeThing(e)[1],o=$.ckGetSomeThing(e)[2];if($.ckIsEmpty(r))return t===!0&&alert("请输入正确格式的URL"),o===!0&&n.focus(),!1;var i=/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;return i.test(r)?!0:(t===!0&&alert("请输入正确格式的URL"),o===!0&&n.focus(),!1)},ckIsMobile:function(e,t){var n=$.ckGetSomeThing(e)[0],r=$.ckGetSomeThing(e)[1],o=$.ckGetSomeThing(e)[2],i=/^(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$/;return i.test(r)?!0:(t===!0&&alert("请输入正确的电话号"),o===!0&&n.focus(),!1)},ckSetCookie:function(e,t,n,r){$.ckIsEmpty(r)&&(r=86400),$.ckIsEmpty(n)&&(n="/");var o=new Date;o.setTime(o.getTime()+1e3*r),document.cookie=e+"="+escape(t)+";path="+n+";expires="+o.toGMTString()},ckGetCookie:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]).replace('"',"").replace('"',""):null},ckDelCookie:function(e){var t=new Date;t.setTime(t.getTime()-1);var n=$.ckGetCookie(e);null!=n&&($.ckSetCookie(e,""),document.cookie=e+"="+n+";expires="+t.toGMTString())},ckObjToJsonStr:function(e){try{return JSON.stringify(e)}catch(t){return""}},ckObjToJson:function(obj){try{return JSON.parse(obj)}catch(e){}try{return obj.parseJSON()}catch(e){}try{return eval("("+obj+")")}catch(e){}return new Object},ckIsEmpty:function(e,t){return void 0==e||"undefined"==e||null==e||"null"==e||"string"==typeof e&&""==e.replace(/(^\s*)|(\s*$)/g,"").replace("&#160;","")?(t===!0&&alert("请输入有效字符"),!0):!1},ckMul:function(e,t){var n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch(i){}try{n+=o.split(".")[1].length}catch(i){}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)},ckAdd:function(e,t){var n,r,o;try{n=e.toString().split(".")[1].length}catch(i){n=0}try{r=t.toString().split(".")[1].length}catch(i){r=0}o=Math.pow(10,Math.max(n,r));var c=(e*o+t*o)/o;return c},ckSub:function(e,t){var n=$.ckAdd(e,-t);return n},ckDiv:function(arg1,arg2){if(0==arg2)return void console.log("非法运算式..");var r1,r2,t1=0,t2=0;try{t1=arg1.toString().split(".")[1].length}catch(e){}try{t2=arg2.toString().split(".")[1].length}catch(e){}with(Math)return r1=Number(arg1.toString().replace(".","")),r2=Number(arg2.toString().replace(".","")),r1/r2*pow(10,t2-t1)},ckMustNumber:function(e,t){var n=window.event?e.keyCode:e.which;if(n>=48&&57>=n||8==n||0==n||45==n||46==n){var r=t.val();-1!=r.indexOf(".")&&r.substring(r.indexOf(".")).length>2?t.val(r.substring(0,r.indexOf(".")+2)):t.val(r),window.event.returnValue=!0}else window.event?window.event.returnValue=!1:e.preventDefault()},ckFmtMoney:function(e,n){var r=/^-?[1-9]\d*.?\d*$/g;if(""==$.ckIsEmpty(e)||0==r.test(e)||0==e)return"";n=n>0&&20>=n?n:2,e=parseFloat((e+"").replace(/[^\d\.-]/g,"")).toFixed(n)+"";var o=e.split(".")[0].split("").reverse(),c=e.split(".")[1];t="";var a=o.length;for(i=0;i<a;i++)t+=o[i]+((i+1)%3==0&&i+1!=o.length?",":"");return(t.split("").reverse().join("")+"."+c).replace("-,","-")},ckRbkMoney:function(e){return""==ckIsEmpty(e)||0==e?"":parseFloat((e+"").replace(/[^\d\.-]/g,""))},ckGoto:function(e){$.ckIsEmpty(e)||(window.location.href=e)},ckShadeFlag:!1,ckShade:function(e,t){if(t?setTimeout('$("#shade_article").remove();',t):setTimeout('$("#shade_article").remove();',4e3),0==e&&"boolean"==typeof e)return $.ckShadeFlag=e,$("#shade_style").remove(),$("#shade_article").hide(),void $("#shade_article").remove();if($.ckShadeFlag)throw alert("请勿重复提交"),"重复提交";var n=$.ckGetContext(),r='<style id="shade_style">@-webkit-keyframes circle{0%{ transform:rotate(0deg); }100%{ transform:rotate(-360deg);}@-ms-keyframes circle{0%{ transform:rotate(0deg); }100%{ transform:rotate(-360deg);}@--moz--keyframes circle{0%{ transform:rotate(0deg); }100%{ transform:rotate(-360deg);}@-o-keyframes circle{0%{ transform:rotate(0deg); }100%{ transform:rotate(-360deg);}</style>',o='<article id="shade_article" style="width:100%;height:100%;position:fixed;background: rgba(0,0,0,0.5);top:0;z-index:1000"><div style="position:absolute;text-align: center;left:0;right:0;margin-top:50%;color:#fff;"><img id="ck_shade_showImg" style="-webkit-animation:circle 0.8s infinite linear;-ms-animation:circle 0.8s infinite linear;-moz-animation:circle 0.8s infinite linear;-o-animation:circle 0.8s infinite linear;" src="'+n+'/resources/images/alertImage/wait.png" alt="" width="10%"/> <br/><br/>正在处理，请稍后...</div></article>';$("body").prepend(r+o),$.ckShadeFlag=!0},ckGetContext:function(){try{var e=window.location.href.split("/"),t=e[0]+"//"+e[1]+e[2]+"/"+e[3];return t}catch(n){return"/"}},ckAlert:function(e){var t=$.ckGetContext(),n={info:"string"==typeof e||"number"==typeof e?e:"",type:1,icon:1,button:{left:"确定",right:"取消"},onSure:function(){},onRefuse:function(){}},r=$("#showInfo").attr("mes");r=r?Number(r)+1:0;var o=$.extend(!0,{},n,e),i="",c="width:50%; float:left;";switch(o.type){case 1:size=12,c="width:100%; float:left;";break;case 2:size=6,i='<a id="onRefuse'+r+'" class="btn" style="'+c+'background-color:#f5ab74 ;color:#fff;padding:6px 12px;">'+o.button.right+"</a>"}$("body").append('<div id="showInfo" mes="'+r+'" class="container" style="width:100%;height:100%;position: fixed;z-index:999;background: rgba(0,0,0,0.4);top:0;"><div style="width:80%;background: #fff;position: absolute;margin:auto;top:34%;left:0;right:0;border-radius: 10px;text-align: center;"><div class="col-xs-12" style="margin-top:-20px;"><img src="'+t+"/js/ckUI/image/alertImg/"+o.icon+'.png" width="30%" alt=""/></div><div class="col-xs-12" style="padding:10% 0;margin-top:-20px;">'+o.info+'</div><a id="onSure'+r+'" class="btn" style="'+c+'background-color:#f83030; color:#fff;padding:6px 12px;">'+o.button.left+"</a>"+i+"</div></div>"),$("#onSure"+r).bind("click",function(){o.onSure(),$("div[mes='"+r+"']").hide().remove()}),$("#onRefuse"+r).bind("click",function(){o.onRefuse(),$("div[mes='"+r+"']").hide().remove()})},ckAnchor:function(){if(!$.ckIsEmpty($("ckAnchor"))){var e=window.location.href.split("/"),t=e[e.length-1].replace("=","");if(t=t.replace("?",""),console.log("锚点已启用: "+$.ckGetCookie(t)),null!=$.ckGetCookie(t))var n=setInterval(function(){$("html").animate({scrollTop:$.ckGetCookie(t)+"px"},800);var e=0;null!=window.pageYOffset&&0!=window.pageYOffset?e=window.pageYOffset:null!=document.body&&0!=document.body.scrollTop?e=document.body.scrollTop:null!=document.documentElement.scrollTop&&0!=document.documentElement.scrollTop&&(e=document.documentElement.scrollTop),console.log("当前坐标: "+e),e==$.ckGetCookie(t)&&clearTimeout(n)},500);else $.ckSetCookie(t,0);$(document).click(function(){var e=0;null!=window.pageYOffset&&0!=window.pageYOffset?e=window.pageYOffset:null!=document.body&&0!=document.body.scrollTop?e=document.body.scrollTop:null!=document.documentElement.scrollTop&&0!=document.documentElement.scrollTop&&(e=document.documentElement.scrollTop),$.ckSetCookie(t,e),console.log("锚点已启用: "+$.ckGetCookie(t))})}},ckGotoView:function(e){$.ckIsEmpty(e)||("/"!=e.substr(0,1)&&(e="/"+e),$.ckGoto($.ckGetContext()+e))},ckCheckCard:function(e,t){var n=$.ckGetSomeThing(e)[0],r=$.ckGetSomeThing(e)[1],o=$.ckGetSomeThing(e)[2],i={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};if($.ckIsEmpty(r))return t===!0&&alert("请输入有效的身份证号"),o===!0&&n.focus(),!1;var c=/(^\d{15}$)|(^\d{17}(\d|X)$)/;if(c.test(r)===!1)return t===!0&&alert("请输入有效的身份证号"),o===!0&&n.focus(),!1;var a=r.substr(0,2);if($.ckIsEmpty(i[a]))return t===!0&&alert("请输入有效的身份证号"),o===!0&&n.focus(),!1;var l=r.length;if("15"==l){var s=/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/,u=r.match(s),d=u[2],f=u[3],p=u[4],k=new Date("19"+d+"/"+f+"/"+p),g=new Date,m=g.getFullYear();if(k.getFullYear()==d&&k.getMonth()+1==f&&k.getDate()==p){var h=m-d;if(3>h||h>100)return t===!0&&alert("请输入有效的身份证号"),o===!0&&n.focus(),!1}}if("18"==l){var v=/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/,u=r.match(v),d=u[2],f=u[3],p=u[4],k=new Date(d+"/"+f+"/"+p),g=new Date,m=g.getFullYear();if(k.getFullYear()==d&&k.getMonth()+1==f&&k.getDate()==p){var h=m-d;if(3>h||h>100)return t===!0&&alert("请输入有效的身份证号"),o===!0&&n.focus(),!1}}if("15"==r.length){var y,w=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),b=new Array("1","0","X","9","8","7","6","5","4","3","2"),S=0;for(r=r.substr(0,6)+"19"+r.substr(6,r.length-6),y=0;17>y;y++)S+=r.substr(y,1)*w[y];r+=b[S%11]}var l=r.length;if("18"==l){var y,x,w=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),b=new Array("1","0","X","9","8","7","6","5","4","3","2"),S=0;for(y=0;17>y;y++)S+=r.substr(y,1)*w[y];return x=b[S%11],x==r.substr(17,1)?!0:(t===!0&&alert("请输入有效的身份证号"),o===!0&&n.focus(),!1)}return!0},ckGetSomeThing:function(e){var t=[];if(e instanceof jQuery)return t.push(e),t.push(e.val()),t.push(!0),t;try{if(!$.ckIsEmpty(e)&&"string"==typeof e&&$("#"+e)instanceof jQuery&&null!=$("#"+e)&&void 0!=$("#"+e)[0]&&"undefined"!=$("#"+e)[0])return t.push($("#"+e)),t.push($("#"+e).val()),t.push(!0),t}catch(n){}return t.push(e),t.push(e),t.push(!1),t}})}(jQuery);